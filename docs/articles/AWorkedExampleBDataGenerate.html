<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="YellowFeverDynamics">
<title>Worked Example 2 - Generating Epidemiological Data Sets • YellowFeverDynamics</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Worked Example 2 - Generating Epidemiological Data Sets">
<meta property="og:description" content="YellowFeverDynamics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">YellowFeverDynamics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/AWorkedExampleAModelRun.html">Worked Example 1 - Single Model Run</a>
    <a class="dropdown-item" href="../articles/AWorkedExampleBDataGenerate.html">Worked Example 2 - Generating Epidemiological Data Sets</a>
    <a class="dropdown-item" href="../articles/AWorkedExampleCMCMC.html">Worked Example 3 - Parameter Estimation Using Markov Chain Monte Carlo Functions</a>
    <a class="dropdown-item" href="../articles/BGuideAInstallation.html">Guide 1 - Installation</a>
    <a class="dropdown-item" href="../articles/BGuideBInputs.html">Guide 2 - Inputs</a>
    <a class="dropdown-item" href="../articles/BGuideCParametersEnvironment.html">Guide 3 - Calculating Parameters From Environmental Data</a>
    <a class="dropdown-item" href="../articles/BGuideDModelResultsProcess.html">Guide 4 - Processing Model Results</a>
    <a class="dropdown-item" href="../articles/BGuideELikelihood.html">Guide 5 - Calculating Likelihood Of Observed Data</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Worked Example 2 - Generating Epidemiological Data Sets</h1>
            
      
      
      <div class="d-none name"><code>AWorkedExampleBDataGenerate.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates how to use the package to generate a set
of epidemiological data (serological, annual reported severe/fatal cases
and/or annual outbreak occurence) for specified time periods and regions
(and age ranges, in the case of serological data). This can either be
set up to match a set of observed data or to create a hypothetical set
of data with no existing counterpart (by matching to “dummy” data).</p>
<p>Next the input data set, regional environmental covariate values,
coefficients of environmental covariate values used to calculate
spillover FOI and R0 values, and observed serological and annual case
data (here generated by the model itself) are loaded.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">YellowFeverDynamics</span><span class="op">)</span></span>
<span><span class="va">input_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">path.package</a></span><span class="op">(</span><span class="st">"YellowFeverDynamics"</span><span class="op">)</span>,<span class="st">"/exdata/input_data_example.Rds"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">enviro_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">path.package</a></span><span class="op">(</span><span class="st">"YellowFeverDynamics"</span><span class="op">)</span>,<span class="st">"/exdata/enviro_data_example.csv"</span>,sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">enviro_coeffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">path.package</a></span><span class="op">(</span><span class="st">"YellowFeverDynamics"</span><span class="op">)</span>,<span class="st">"/exdata/enviro_coeffs_example.csv"</span>,sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">obs_sero_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">path.package</a></span><span class="op">(</span><span class="st">"YellowFeverDynamics"</span><span class="op">)</span>,<span class="st">"/exdata/sero_data_example_single.csv"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>,header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>    </span>
<span>                      <span class="co"># Seroprevalence data for comparison, by region, year &amp; age group, in format no. samples/no. positives</span></span>
<span><span class="va">obs_case_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">path.package</a></span><span class="op">(</span><span class="st">"YellowFeverDynamics"</span><span class="op">)</span>,<span class="st">"/exdata/case_data_example_single.csv"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>,header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>    </span>
<span>                      <span class="co"># Annual reported case/death data for comparison, by region and year, in format no. cases/no. deaths</span></span>
<span><span class="va">obs_outbreak_data</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>                      <span class="co"># Outbreak Y/N data for comparison, by region and year, in format 0 = no outbreaks, 1 = 1 or more outbreak(s) (here simply set to NULL)</span></span></code></pre></div>
<p>Additional inputs for the data_match_single() function, which is used
to generate model data to match observed or dummy data, are set as
follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">param_prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">enviro_coeffs</span><span class="op">)</span></span>
<span>                      <span class="co"># Parameters input to produce model parameters, potentially including spillover FOI and R0 by region, severe and fatal case reporting probability</span></span>
<span><span class="va">const_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"FOI+R0 enviro"</span>,n_reps<span class="op">=</span><span class="fl">1</span>,mode_start<span class="op">=</span><span class="fl">1</span>,dt<span class="op">=</span><span class="fl">1.0</span>,enviro_data<span class="op">=</span><span class="va">enviro_data</span>,R0_fixed_values<span class="op">=</span><span class="cn">NULL</span>,vaccine_efficacy<span class="op">=</span><span class="fl">1.0</span>,p_rep_severe<span class="op">=</span><span class="fl">0.05</span>,p_rep_death<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span>                      <span class="co"># List containing additional parameters: type of parameter set used to calculate spillover FOI and R0 (here both calculated from environmental covariates), number of repetitions for which to run model and obtain average outputs, environmental covariate data, fixed R0 values by region used when R0 is not a variable, and values of vaccine efficacy and severe and fatal case reporting probability used when these are not variables set via param_prop</span></span></code></pre></div>
<p>The data_match_single() function is run to produce a set of modelled
data matching the observed data, i.e.:</p>
<p>-Seroprevalence values for the same age group(s) in the same year(s)
-Numbers of reported cases and deaths in the same year(s) -Outbreak
occurence data for the same year(s)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_match_single.html">data_match_single</a></span><span class="op">(</span><span class="va">param_prop</span>,<span class="va">input_data</span>,<span class="va">obs_sero_data</span>,<span class="va">obs_case_data</span>,<span class="va">obs_outbreak_data</span>,<span class="va">const_list</span><span class="op">)</span></span></code></pre></div>
<p>A data_match_multi() function exists to run data_match_single() for a
series of sets of values of the input parameters. The inputs are the
same except that the parameter values are input as a data frame
containing one set of parameter values per line.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">param_sets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">path.package</a></span><span class="op">(</span><span class="st">"YellowFeverDynamics"</span><span class="op">)</span>,<span class="st">"/exdata/enviro_coeffs_example2.csv"</span>,sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_match_multi.html">data_match_multi</a></span><span class="op">(</span><span class="va">param_sets</span>,<span class="va">input_data</span>,<span class="va">obs_sero_data</span>,<span class="va">obs_case_data</span>,<span class="va">obs_outbreak_data</span>,<span class="va">const_list</span><span class="op">)</span></span></code></pre></div>
<p>Data output from data_match_single() and data_match_multi() can be
plotted together with the observed data on which it is based, using the
sero_match_graphs() and case_match_graphs() functions. Observed data is
shown (unless the hide_observed variable is set to TRUE) in black with
error bars representing a binomial confidence interval (serological
data) or negative binomial confidence interval (case data). Modelled
data is shown in blue and green; if data matching was carried out for
multiple parameter sets using data_match_multi(), the distribution of
results can be shown. If the plot_type variable is set to “mean”, the
mean of the results is displayed with 95% and 50% confidence intervals
(in blue and green respectively). If plot_type is set to “all”, the 95%
and 50% of values closest to the mean are shown in blue and green
respectively.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sero_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sero_match_graphs.html">sero_match_graphs</a></span><span class="op">(</span><span class="va">data2</span>,<span class="va">obs_sero_data</span>,plot_type<span class="op">=</span><span class="st">"all"</span>,text_size<span class="op">=</span><span class="fl">10</span>,hide_observed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sero_graph</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">case_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/case_match_graphs.html">case_match_graphs</a></span><span class="op">(</span><span class="va">data2</span>,<span class="va">obs_case_data</span>,<span class="va">input_data</span>,plot_type<span class="op">=</span><span class="st">"mean"</span>,text_size<span class="op">=</span><span class="fl">10</span>,hide_observed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">Rmisc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rmisc/man/multiplot.html" class="external-link">multiplot</a></span><span class="op">(</span><span class="va">case_graph</span><span class="op">$</span><span class="va">cases_graphs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">case_graph</span><span class="op">$</span><span class="va">deaths_graphs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Keith Fraser.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
