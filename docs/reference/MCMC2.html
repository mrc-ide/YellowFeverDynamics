<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Combined MCMC Multi-Region - series of MCMC steps for one or more regions"><title>MCMC2 — MCMC2 • YellowFeverDynamics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MCMC2 — MCMC2"><meta property="og:description" content="Combined MCMC Multi-Region - series of MCMC steps for one or more regions"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">YellowFeverDynamics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/02%20Individual%20Model%20Run.html">ModelRun</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>MCMC2</h1>
      
      <div class="d-none name"><code>MCMC2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Combined MCMC Multi-Region - series of MCMC steps for one or more regions</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">MCMC2</span><span class="op">(</span>
  pars_ini <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  input_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  obs_sero_data <span class="op">=</span> <span class="cn">NULL</span>,
  obs_case_data <span class="op">=</span> <span class="cn">NULL</span>,
  obs_outbreak_data <span class="op">=</span> <span class="cn">NULL</span>,
  Niter <span class="op">=</span> <span class="fl">1</span>,
  type <span class="op">=</span> <span class="cn">NULL</span>,
  pars_min <span class="op">=</span> <span class="cn">NULL</span>,
  pars_max <span class="op">=</span> <span class="cn">NULL</span>,
  n_reps <span class="op">=</span> <span class="fl">1</span>,
  mode_start <span class="op">=</span> <span class="fl">0</span>,
  prior_type <span class="op">=</span> <span class="st">"zero"</span>,
  dt <span class="op">=</span> <span class="fl">1</span>,
  enviro_data <span class="op">=</span> <span class="cn">NULL</span>,
  R0_fixed_values <span class="op">=</span> <span class="cn">NULL</span>,
  vaccine_efficacy <span class="op">=</span> <span class="cn">NULL</span>,
  p_rep_severe <span class="op">=</span> <span class="cn">NULL</span>,
  p_rep_death <span class="op">=</span> <span class="cn">NULL</span>,
  filename_prefix <span class="op">=</span> <span class="st">"Chain"</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>pars_ini</dt>
<dd><p>Initial values of parameters to be fitted. These should always be the log() values of the actual
epidemiological parameters, ordered as follows:
1) Parameters controlling the value of spillover force of infection FOI, either a) a number of FOI values equal to
the total number of regions to be considered or b) a number of environmental coefficients used to calculate FOI
values from environmental covariates equal to the number of environmental covariates listed in the enviro_data
frame. Values should be in alphabetical order by region in case (a) or in the order of the columns in the
environmental data frame in case (b).
2) If the basic reproduction number for human-human transmission R0 is to be fitted (i.e. type is set to
"FOI+R0" or "FOI+R0 enviro"), parameters controlling the value of R0, either a) a number of R0 values equal to
the total number of regions to be considered or b) a number of environmental coefficients used to calculate R0
values from environmental covariates equal to the number of environmental covariates listed in the enviro_data
frame. Values should be in alphabetical order by region in case (a) or in the order of the columns in the
environmental data frame in case (b).
3) Values of the additional parameters (vaccine efficacy vaccine_efficacy, severe case reporting probability
p_rep_severe and fatal case reporting probability p_rep_death) if these are to be fitted, in the order
vaccine_efficacy-&gt;p_rep_severe-&gt;p_rep_death. If these parameters are to be fitted, the values separately supplied
to this function (see below) should be set to NULL, the default.</p></dd>
<dt>input_data</dt>
<dd><p>List of population and vaccination data for multiple regions (created using data input creation
code and usually loaded from RDS file)</p></dd>
<dt>obs_sero_data</dt>
<dd><p>Seroprevalence data for comparison, by region, year &amp; age group, in format no. samples/no.
positives</p></dd>
<dt>obs_case_data</dt>
<dd><p>Annual reported case/death data for comparison, by region and year, in format no.
cases/no. deaths</p></dd>
<dt>obs_outbreak_data</dt>
<dd><p>Outbreak Y/N data for comparison, by region and year, in format 0 = no outbreaks,
1 = 1 or more outbreak(s)</p></dd>
<dt>Niter</dt>
<dd><p>Total number of steps to run</p></dd>
<dt>type</dt>
<dd><p>Type of parameter set (FOI only, FOI+R0, FOI and/or R0 coefficients associated with environmental
covariates); choose from "FOI","FOI+R0","FOI enviro","FOI+R0 enviro"</p></dd>
<dt>pars_min</dt>
<dd><p>Lower limits of parameter values if specified</p></dd>
<dt>pars_max</dt>
<dd><p>Upper limits of parameter values if specified</p></dd>
<dt>n_reps</dt>
<dd><p>Number of times to repeat calculations to get average likelihood at each step</p></dd>
<dt>mode_start</dt>
<dd><p>Flag indicating how to set initial population immunity level in addition to vaccination
If mode_start = 0, only vaccinated individuals
If mode_start = 1, shift some non-vaccinated individuals into recovered to give herd immunity</p></dd>
<dt>prior_type</dt>
<dd><p>Text indicating which type of calculation to use for prior probability
If prior_type = "zero", prior probability is always zero
If prior_type = "flat", prior probability is zero if FOI/R0 in designated ranges, -Inf otherwise
If prior_type = "exp", prior probability is given by dexp calculation on FOI/R0 values
If prior_type = "norm", prior probability is given by dnorm calculation on parameter values</p></dd>
<dt>dt</dt>
<dd><p>time increment in days (must be 1 or 5)</p></dd>
<dt>enviro_data</dt>
<dd><p>Data frame containing values of environmental covariates; set to NULL if not in use</p></dd>
<dt>R0_fixed_values</dt>
<dd><p>Values of R0 to use if only FOI is subject to fitting (i.e. type set to "FOI" or "FOI
enviro"); set to NULL if not in use</p></dd>
<dt>vaccine_efficacy</dt>
<dd><p>Vaccine efficacy (set to NULL if being varied as a parameter)</p></dd>
<dt>p_rep_severe</dt>
<dd><p>Probability of observation of severe infection (set to NULL if being varied as a parameter)</p></dd>
<dt>p_rep_death</dt>
<dd><p>Probability of observation of death (set to NULL if being varied as a parameter)</p></dd>
<dt>filename_prefix</dt>
<dd><p>Prefix of names for output files
'</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This is the master function for running a Markov chain to optimize the parameters of the yellow fever model
based on the calculated likelihood of observing supplied data given a particular set of parameters. [TBC]</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Keith Fraser.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

