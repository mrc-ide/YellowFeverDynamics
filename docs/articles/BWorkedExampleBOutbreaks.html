<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="YellowFeverDynamics">
<title>Worked Example 2 - Outbreak Modelling • YellowFeverDynamics</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Worked Example 2 - Outbreak Modelling">
<meta property="og:description" content="YellowFeverDynamics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">YellowFeverDynamics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/A1Introduction.html">Introduction</a>
    <a class="dropdown-item" href="../articles/A2Installation.html">Installation</a>
    <a class="dropdown-item" href="../articles/BWorkedExampleAModelRun.html">Worked Example 1 - Single Model Run</a>
    <a class="dropdown-item" href="../articles/BWorkedExampleBOutbreaks.html">Worked Example 2 - Outbreak Modelling</a>
    <a class="dropdown-item" href="../articles/BWorkedExampleCDataGenerate.html">Worked Example 3 - Generating Epidemiological Data Sets</a>
    <a class="dropdown-item" href="../articles/BWorkedExampleDBurden.html">Worked Example 4 - Yellow Fever Burden Calculation</a>
    <a class="dropdown-item" href="../articles/BWorkedExampleEMCMC.html">Worked Example 5 - Parameter Estimation Using Markov Chain Monte Carlo Functions</a>
    <a class="dropdown-item" href="../articles/CGuideAInputs.html">Guide 1 - Inputs</a>
    <a class="dropdown-item" href="../articles/CGuideBParametersEnvironment.html">Guide 2 - Calculating Parameters From Environmental Data</a>
    <a class="dropdown-item" href="../articles/CGuideCModelResultsProcess.html">Guide 3 - Processing Model Results</a>
    <a class="dropdown-item" href="../articles/CGuideDLikelihood.html">Guide 5 - Calculating Likelihood Of Observed Data</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Worked Example 2 - Outbreak Modelling</h1>
            
      
      
      <div class="d-none name"><code>BWorkedExampleBOutbreaks.Rmd</code></div>
    </div>

    
    
<p>This worked example demonstrates several ways the package can be used
to model the occurrence and risk of yellow fever outbreaks. An
“outbreak” is defined as taking place whenever a case of yellow fever is
reported, and lasts as long as the time interval between new cases
remains less than 10 days (the sum of the incubation and infectious
periods used by the package).</p>
<p>The reporting of yellow fever cases is governed by the probability of
an infection which causes severe but non-fatal symptoms being reported
(p_rep_severe) and the probability of a fatal infection being reported
(p_rep_death). It is assumed that infections not leading to severe or
fatal symptoms are not reported. The proportion of infections which
cause severe symptoms is given by the quantity p_severe_inf, and the
proportion of severe infections which lead to death is given by the
quantity p_death_severe_inf. These have values of 0.12 and 0.39
respectively within the package, based on <a href="https://doi.org/10.1186/s12879-021-06535-4" class="external-link">Servadio et
al</a>.</p>
<p>As described in <a href="https://mrc-ide.github.io/YellowFeverDynamics/articles/BWorkedExampleAModelRun.html" class="external-link">Worked
Example 1 - Single Model Run</a>, we obtain data on the number of new
infectious individuals at each time point during a modelled period from
the case_data_generate() function:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">YellowFeverDynamics</span><span class="op">)</span></span>
<span><span class="va">input_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">path.package</a></span><span class="op">(</span><span class="st">"YellowFeverDynamics"</span><span class="op">)</span>, <span class="st">"/exdata/input_data_example.Rds"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">vacc_data</span> <span class="op">&lt;-</span> <span class="va">input_data</span><span class="op">$</span><span class="va">vacc_data</span><span class="op">[</span><span class="fl">1</span>, , <span class="op">]</span></span>
<span><span class="va">pop_data</span> <span class="op">&lt;-</span> <span class="va">input_data</span><span class="op">$</span><span class="va">pop_data</span><span class="op">[</span><span class="fl">1</span>, , <span class="op">]</span>  </span>
<span><span class="va">FOI_spillover</span> <span class="op">&lt;-</span> <span class="fl">3.0e-7</span>             <span class="co"># Force of infection due to spillover from sylvatic reservoir</span></span>
<span><span class="va">R0</span> <span class="op">&lt;-</span> <span class="fl">0.0</span>                           <span class="co"># Basic reproduction number for urban spread of infection</span></span>
<span><span class="va">model_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/case_data_generate.html">case_data_generate</a></span><span class="op">(</span><span class="va">FOI_spillover</span>, <span class="va">R0</span>, <span class="va">vacc_data</span>, <span class="va">pop_data</span>, year0 <span class="op">=</span> <span class="va">input_data</span><span class="op">$</span><span class="va">years_labels</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, mode_start <span class="op">=</span> <span class="fl">1</span>, n_reps <span class="op">=</span> <span class="fl">1</span>, year_end <span class="op">=</span> <span class="fl">2001</span>, year_data_begin <span class="op">=</span> <span class="fl">1999</span>, vaccine_efficacy <span class="op">=</span> <span class="fl">1.0</span>, start_SEIRV <span class="op">=</span> <span class="cn">NULL</span>, dt <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span></span></code></pre></div>
<p>We process results using the get_outbreak_data() function to produce
information on all outbreaks and reported cases during the modelled time
period.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">case_data</span> <span class="op">=</span> <span class="va">model_results</span><span class="op">$</span><span class="va">C</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="co"># Vector of data points showing number of new cases at each time point [TBC]</span></span>
<span><span class="va">year_data</span> <span class="op">=</span> <span class="va">model_results</span><span class="op">$</span><span class="va">year</span> <span class="co"># Matching vector indicating the year for each time point [TBC]</span></span>
<span><span class="va">p_rep_severe</span> <span class="op">=</span> <span class="fl">0.1</span> <span class="co"># The probability of a case with severe but non-fatal symptoms being reported</span></span>
<span><span class="va">p_rep_death</span> <span class="op">=</span> <span class="fl">0.2</span> <span class="co"># The probability of a fatal case being reported</span></span>
<span><span class="va">outbreak_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_outbreak_data.html">get_outbreak_data</a></span><span class="op">(</span><span class="va">case_data</span>, <span class="va">year_data</span>, <span class="va">p_rep_severe</span>, <span class="va">p_rep_death</span><span class="op">)</span></span></code></pre></div>
<p>get_outbreak_data() produces a list containing the number of
outbreaks (n_outbreaks), data on each individual outbreak (outbreak_list
- number of reported cases, start and end days and years), a time series
showing the number of reported cases and deaths at each time point
(rep_pts), and a time series showing the number of reported cases and
deaths in each year (rep_annual).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outbreak_data</span><span class="op">$</span><span class="va">outbreak_list</span></span>
<span><span class="co">#&gt;   size start_day end_day start_year end_year</span></span>
<span><span class="co">#&gt; 1    1       144     154       1999     1999</span></span>
<span><span class="co">#&gt; 2    1       351     361       1999     1999</span></span>
<span><span class="co">#&gt; 3    1       412     422       2000     2000</span></span>
<span><span class="co">#&gt; 4    1       483     493       2000     2000</span></span>
<span><span class="co">#&gt; 5    1       530     540       2000     2000</span></span>
<span><span class="co">#&gt; 6    1       656     666       2000     2000</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outbreak_data</span><span class="op">$</span><span class="va">rep_annual</span></span>
<span><span class="co">#&gt;   year rep_cases rep_deaths</span></span>
<span><span class="co">#&gt; 1 1999         2          1</span></span>
<span><span class="co">#&gt; 2 2000         4          3</span></span></code></pre></div>
<p>As noted in <a href="https://mrc-ide.github.io/YellowFeverDynamics/articles/BWorkedExampleAModelRun.html" class="external-link">Worked
Example 1</a>, we can estimate the outbreak risk (the probability of one
or more outbreaks, i.e. one or more reported cases) in a given time
period by running the model a large number of times and calculating the
proportion of repetitions in which one or more cases are reported. This
is automated by using the outbreak_risk_generate() function. This
function runs the time before the period of interest n_sets times, then
models the period of interest n_reps times for each set, giving n_sets
sets of values of annual outbreak risk:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outbreak_risk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outbreak_risk_generate.html">outbreak_risk_generate</a></span><span class="op">(</span><span class="va">FOI_spillover</span>, <span class="va">R0</span>, <span class="va">vacc_data</span>, <span class="va">pop_data</span>, year0 <span class="op">=</span> <span class="va">input_data</span><span class="op">$</span><span class="va">years_labels</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, mode_start <span class="op">=</span> <span class="fl">1</span>, n_sets<span class="op">=</span><span class="fl">1</span>, n_reps <span class="op">=</span> <span class="fl">100</span>, year_end <span class="op">=</span> <span class="fl">2005</span>, year_data_begin <span class="op">=</span> <span class="fl">1999</span>, vaccine_efficacy <span class="op">=</span> <span class="fl">1.0</span>, start_SEIRV <span class="op">=</span> <span class="cn">NULL</span>, dt <span class="op">=</span> <span class="fl">1.0</span>, <span class="va">p_rep_severe</span>, <span class="va">p_rep_death</span><span class="op">)</span></span>
<span><span class="va">outbreak_risk</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span><span class="co">#&gt; [1,]    1    1    1    1    1    1</span></span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Keith Fraser.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
