---
title: "Vignette 4 - Calculating Parameters From Environmental Data"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette 4 - Calculating Parameters From Environmental Data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This vignette demonstrates how the package generates values of epidemiological parameters (the force of infection for spillover from the sylvatic reservoir and the basic reproduction number for human-to-human transmission) from environmental covariates. This approach is used to calculate epidemiological parameter values for a set of regions with known values of environmental covariates from a single set of coefficients.

For more information and background on the use of environmental covariates and the selection of covariates for use, see [TBA - citation]

First load the package:

```{r}
library(YellowFeverDynamics)
```

Environmental data is stored as a data frame with each line containing covariate values for one region, with the headings giving the variable names.

```{r}
enviro_data=read.csv(file=paste(path.package("YellowFeverDynamics"),"/exdata/enviro_data_example.csv",sep=""),header=TRUE)
head(enviro_data,5)
```

Logarithmic values of the coefficients of the environmental covariates are stored as a data frame with the headings in the format FOI_(variable name) and R0_(variable name). In the example below, only one set of coefficient values are given, but multiple sets of values (e.g. a distribution of value estimates) can be used to produce a distribution of results.

```{r}
enviro_coeffs=read.csv(file=paste(path.package("YellowFeverDynamics"),"/exdata/enviro_coeffs_example.csv",sep=""),header=TRUE)
enviro_coeffs
```

Covariate and coefficient values can be combined to produce value of the spillover force of infection and basic reproduction number using the param_calc_enviro function.

```{r}
n_regions=nrow(enviro_data)
epi_data=data.frame(region=enviro_data$adm1,FOI=rep(NA,n_regions),R0=rep(NA,n_regions))
for(n_region in 1:n_regions){
 FOI_R0_values=param_calc_enviro(param=as.numeric(enviro_coeffs[1,]),enviro_data=enviro_data[n_region,])
 epi_data$FOI[n_region]=FOI_R0_values$FOI
 epi_data$R0[n_region]=FOI_R0_values$R0
}
head(epi_data,5)
```
