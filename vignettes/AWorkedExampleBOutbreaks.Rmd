---
title: "Worked Example 3 - Outbreak Modelling"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Worked Example 3 - Outbreak Modelling}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This vignette describes several ways the package can be used to model the occurrence and risk of yellow fever outbreaks. An "outbreak" is defined as taking place whenever a case of yellow fever is reported, and lasts as long as the time interval between new cases remains less than 10 days (the sum of the incubation and infectious periods used by the package).

As described in [Worked Example 1 - Single Model Run](https://mrc-ide.github.io/YellowFeverDynamics/articles/AWorkedExampleAModelRun.html), data on the number of "cases" (new infectious individuals) at each time point during a modelled period can be output by the Full_Model_Run() and case_data_generate() functions.

```{r,eval=FALSE}
library(YellowFeverDynamics)
input_data <- readRDS(file = paste(path.package("YellowFeverDynamics"), "/exdata/input_data_example.Rds", sep = ""))
vacc_data <- input_data$vacc_data[1, , ]
pop_data <- input_data$pop_data[1, , ]  
FOI_spillover <- 1.0e-8             # Force of infection due to spillover from sylvatic reservoir
R0 <- 1.0                           # Basic reproduction number for urban spread of infection
model_results <- case_data_generate(FOI_spillover, R0, vacc_data, pop_data, year0 = input_data$years_labels[1], mode_start = 1, n_reps = 1, year_end = 2001, year_data_begin = 1999, vaccine_efficacy = 1.0, start_SEIRV = NULL, dt = 1.0)
```

The results can be processed using the get_outbreak_data() function to produce information on all outbreaks and reported cases during the modelled time period.

```{r,eval=FALSE}
case_data = round(model_results$C[1,]) # Vector of data points showing number of new cases at each time point [TBC]
year_data = model_results$year # Matching vector indicating the year for each time point [TBC]
p_rep_severe = 0.1 # The probability of a case with severe but non-fatal symptoms being reported
p_rep_death = 0.2 # The probability of a fatal case being reported
outbreak_data <- get_outbreak_data(case_data, year_data, p_rep_severe, p_rep_death)
```

get_outbreak_data() produces a list containing the number of outbreaks, data on each individual outbreak (number of reported cases, start and end days and years), time series showing the number of reported cases and deaths at each time point, and time series showing the number of reported cases and deaths in each year.

```{r,eval=FALSE}
#[TBA - Results]
```

[TBA]

```{r,eval=FALSE}
# TBA - Use of outbreak_risk_generate() function
```
